mode: rule
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7895
ipv6: false
log-level: info
unified-delay: true

# GEO æ•°æ®åº“æ¨¡å¼é…ç½®ï¼Œå¯ç”¨è¯¥åŠŸèƒ½ä»¥è·å–å’Œä½¿ç”¨åœ°ç†ä½ç½®ä¿¡æ¯
geodata-mode: true

# GEO æ•°æ®åº“åŠ è½½æ¨¡å¼ï¼Œé€‰æ‹©åˆé€‚çš„å†…å­˜å ç”¨ç­–ç•¥
# 'memconservative' é€‚ç”¨äºè¾ƒä½å†…å­˜å ç”¨ï¼Œä¿è¯ç³»ç»Ÿæ€§èƒ½
geodata-loader: memconservative
geo-auto-update: true
geo-update-interval: 24
# è‡ªå®š GEO ä¸‹è½½åœ°å€
geox-url:
  geosite: https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat
  mmdb: https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb
  geoip: https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat
  asn: https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb
  
  
profile:
  store-selected: true
  store-fake-ip: true



sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain: # å¿½ç•¥å—…æ¢
    - 'rule-set:CN_domain'
    - 'Mijia Cloud'
    - '+.push.apple.com'
    - '+.wechat.com'
    - '+.qpic.cn'
    - '+.qq.com'
    - '+.wechatapp.com'
    #  è¯­éŸ³é€šä¿¡
    - '+.vivox.com'
    # å‘æ—¥è‘µæœåŠ¡
    - '+.oray.com'
    - '+.sunlogin.net'

tun:
  enable: true
  stack: mixed
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true
  strict-route: true
  dns-hijack:
    - any:53

dns:
  enable: true
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  default-nameserver:
    - 119.29.29.29
    - 180.184.1.1
    - 223.5.5.5
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  fake-ip-filter:
    - 'rule-set:CN_domain'
    - "geosite:private"
    - '*.lan'
    - '*.local'
    - '*.local.lan'
    - '*.internal'
    - '*.localdomain'
    - +.miwifi.com
    - +.docker.io
    - +.market.xiaomi.com
    - +.push.apple.com

    
# èŠ‚ç‚¹ç­›é€‰
FilterHK: &FilterHK '^(?=.*(é¦™æ¸¯|HK|Hong|ğŸ‡­ğŸ‡°))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterJP: &FilterJP '^(?=.*(æ—¥æœ¬|JP|Japan|ğŸ‡¯ğŸ‡µ))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterKR: &FilterKR '^(?=.*(éŸ©å›½|éŸ“|KR|Korea|ğŸ‡°ğŸ‡·))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterSG: &FilterSG '^(?=.*(æ–°åŠ å¡|ç‹®åŸ|SG|Singapore|ğŸ‡¸ğŸ‡¬))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterUS: &FilterUS '^(?=.*(ç¾å›½|US|United States|America|ğŸ‡ºğŸ‡¸))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterUK: &FilterUK '^(?=.*(è‹±å›½|UK|United Kingdom|ğŸ‡¬ğŸ‡§))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterFR: &FilterFR '^(?=.*(æ³•å›½|FR|France|ğŸ‡«ğŸ‡·))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterDE: &FilterDE '^(?=.*(å¾·å›½|DE|Germany|ğŸ‡©ğŸ‡ª))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterTW: &FilterTW '^(?=.*(å°æ¹¾|TW|Taiwan|Wan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterZJ: &FilterZJ '^(?=.*(è‡ªå»º))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterDB: &FilterDB '^(?=.*(0.1|0.01|0.2|è‡ªå»º))^(?!.*(ç½‘ç«™|åœ°å€|å‰©ä½™|è¿‡æœŸ|æ—¶é—´|æœ‰æ•ˆ|ç½‘å€|ç¦æ­¢|é‚®ç®±|å‘å¸ƒ|å®¢æœ|è®¢é˜…|èŠ‚ç‚¹)).*$'
FilterOthers: &FilterOthers '^(?!.*(ğŸ‡­ğŸ‡°|HK|Hong|é¦™æ¸¯|ğŸ‡¹ğŸ‡¼|TW|Taiwan|Wan|ğŸ‡¯ğŸ‡µ|JP|Japan|æ—¥æœ¬|ğŸ‡¸ğŸ‡¬|SG|Singapore|ç‹®åŸ|ğŸ‡ºğŸ‡¸|US|United States|America|ç¾å›½|ğŸ‡©ğŸ‡ª|DE|Germany|å¾·å›½|ğŸ‡¬ğŸ‡§|UK|United Kingdom|è‹±å›½|ğŸ‡°ğŸ‡·|KR|Korea|éŸ©å›½|éŸ“|ğŸ‡«ğŸ‡·|FR|France|æ³•å›½)).*$'
FilterAll: &FilterAll '^(?=.*(.))(?!.*((?i)ç¾¤|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|(\b(USE|USED|TOTAL|EXPIRE|EMAIL|Panel|Channel|Author)\b|(\d{4}-\d{2}-\d{2}|\d+G)))).*$'

Select: &Select {type: select, url: 'https://cp.cloudflare.com/generate_204', disable-udp: false, hidden: false, include-all: true}
Auto: &Auto {type: url-test, url: 'https://cp.cloudflare.com/generate_204', interval: 300, tolerance: 50, disable-udp: false, hidden: true, include-all: true}
Fallback: &Fallback {type: fallback, url: 'https://cp.cloudflare.com/generate_204', interval: 200, lazy: true, include-all: true}
Smart: &Smart {type: smart, url: 'https://cp.cloudflare.com/generate_204', interval: 200, lazy: true, hidden: false, include-all: true, uselightgbm: true}


proxy-groups:
# åˆ†æµåˆ†ç»„


  - {name: å…¨çƒåŠ é€Ÿ, type: select, proxies: [é¦™æ¸¯, é¦™æ¸¯æ™ºèƒ½, æ—¥æœ¬, æ–°åŠ å¡, ç¾å›½, è‡ªå»º, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Global.png }
  - {name: Telegram, type: select, proxies: [æ–°åŠ å¡, æ–°åŠ å¡æ™ºèƒ½, é¦™æ¸¯, é¦™æ¸¯æ™ºèƒ½, åª’ä½“, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Telegram.png }
  - {name: YouTube, type: select, proxies: [é¦™æ¸¯, é¦™æ¸¯æ™ºèƒ½, æ—¥æœ¬, æ–°åŠ å¡, ç¾å›½, åª’ä½“, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/YouTube.png }
  - {name: æ™ºèƒ½åŠ©ç†,   type: select, proxies: [è‡ªå»º, ç¾å›½, æ—¥æœ¬, æ–°åŠ å¡, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/OpenAI.png }
  - {name: è°·æ­ŒæœåŠ¡, type: select, proxies: [è‡ªå»º, ç¾å›½, æ—¥æœ¬, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Google.png }
  - {name: Emby,   type: select, proxies: [DIRECT, åª’ä½“, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Emby.png }
  
  #- {name: å¾®è½¯æœåŠ¡, type: select, proxies: [DIRECT, é¦™æ¸¯, æ—¥æœ¬, æ–°åŠ å¡, ç¾å›½, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Microsoft.png }
  #- {name: è‹¹æœæœåŠ¡, type: select, proxies: [DIRECT, é¦™æ¸¯, æ—¥æœ¬, æ–°åŠ å¡, ç¾å›½, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Apple.png }
  #- {name: æ¸¸æˆå¹³å°, type: select, proxies: [DIRECT, é¦™æ¸¯, æ—¥æœ¬, æ–°åŠ å¡, ç¾å›½, Proxy], icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/GAME.png }
  
 

  # æ‰‹åŠ¨é€‰æ‹©
  - {name: é¦™æ¸¯, <<: *Select, filter: *FilterHK , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/HK.png}
  - {name: æ—¥æœ¬, <<: *Select, filter: *FilterJP , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/JP.png}
  - {name: æ–°åŠ å¡, <<: *Select, filter: *FilterSG , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/SG.png}
  - {name: ç¾å›½, <<: *Select, filter: *FilterUS , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/US.png}
  #- {name: å°æ¹¾, <<: *Select, filter: *FilterTW , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/TW.png}
  
  - {name: åª’ä½“, <<: *Select, filter: *FilterDB, icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/shadowrocket.png}
  - {name: è‡ªå»º, <<: *Select, filter: *FilterZJ, icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/shadowrocket.png}


  - {name: é¦™æ¸¯æ™ºèƒ½,  <<: *Smart, filter: *FilterHK, policy-priority: 'ä¸“çº¿:1.1;é«˜é€Ÿ:0.9', icon: https://git.imee.me/https://github.com/Koolson/Qure/raw/master/IconSet/Color/Hong_Kong.png}
  - {name: æ–°åŠ å¡æ™ºèƒ½,  <<: *Smart, filter: *FilterSG, policy-priority: 'ä¸“çº¿:1.1;é«˜é€Ÿ:0.9', icon: https://git.imee.me/https://github.com/Koolson/Qure/raw/master/IconSet/Color/Singapore.png}
  # è‡ªåŠ¨é€‰æ‹©
  #- {name: é¦™æ¸¯è‡ªåŠ¨, <<: *Auto, filter: *FilterHK , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/HK.png}
  #- {name: æ—¥æœ¬è‡ªåŠ¨, <<: *Auto, filter: *FilterJP , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/JP.png}
  #- {name: æ–°åŠ å¡è‡ªåŠ¨, <<: *Auto, filter: *FilterSG , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/SG.png}
  #- {name: å°æ¹¾è‡ªåŠ¨, <<: *Auto, filter: *FilterTW , icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/TW.png}

  
  # å…¨éƒ¨èŠ‚ç‚¹
  - {name: Proxy, <<: *Select, filter: *FilterAll, icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/shadowrocket.png}


rule-anchor:
# é”šç‚¹ - è§„åˆ™å‚æ•° [æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡è®¢é˜…è§„åˆ™ï¼Œæ›´æ–°è§„åˆ™æ—¶ä½¿ç”¨ä»£ç†ç­–ç•¥]

  RuleSet_classical: &RuleSet_classical {type: http, behavior: classical, interval: 86400, format: yaml, proxy: å…¨çƒåŠ é€Ÿ}
  RuleSet_domain: &RuleSet_domain {type: http, behavior: domain, interval: 86400, format: mrs, proxy: å…¨çƒåŠ é€Ÿ}
  RuleSet_ipcidr: &RuleSet_ipcidr {type: http, behavior: ipcidr, interval: 86400, format: mrs, proxy: å…¨çƒåŠ é€Ÿ}



  ip: &ip {type: http, interval: 86400, behavior: ipcidr, format: yaml, proxy: å…¨çƒåŠ é€Ÿ}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: yaml, proxy: å…¨çƒåŠ é€Ÿ}
  domaintxt: &domaintxt {type: http, interval: 86400, behavior: domain, format: text, proxy: å…¨çƒåŠ é€Ÿ}
  classicaltxt: &classicaltxt {type: http, interval: 86400, behavior: classical, format: text, proxy: å…¨çƒåŠ é€Ÿ}



# åˆ†æµè§„åˆ™ 
rule-providers:
  
  Outside:
    <<: *RuleSet_classical
    path: './ruleset/Outside.yaml'
    url: 'https://raw.githubusercontent.com/Review977/ProxyTools/main/Rules/Proxy.yaml' 

  Inside:
    <<: *RuleSet_classical
    path: './ruleset/Inside.yaml'
    url: 'https://raw.githubusercontent.com/Review977/ProxyTools/main/Rules/Direct.yaml'

  Emby:
    <<: *RuleSet_classical
    path: './ruleset/Emby.yaml'
    url: 'https://raw.githubusercontent.com/Review977/ProxyTools/main/Rules/Emby.yaml'
    
  Telegram:   
    <<: *RuleSet_classical
    path: './ruleset/Telegram.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml'
     
  YouTube:
    <<: *RuleSet_classical
    path: './ruleset/YouTube.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml'
    
  OpenAi:
    <<: *RuleSet_classical
    path: './ruleset/OpenAi.yaml'
    url: 'https://gist.githubusercontent.com/ddgksf2013/cb4121e8b5c5d865cc949cb8120320c4/raw/Ai.yaml'
    
  Google:
    <<: *RuleSet_classical
    path: './ruleset/Google.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml'        
  
  Github:
    <<: *RuleSet_classical
    path: './ruleset/Github.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GitHub/GitHub.yaml'                  
  
  SpeedTest: 
    <<: *RuleSet_classical
    path: './ruleset/SpeedTest.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Speedtest/Speedtest.yaml'
  
  Microsoft:
    <<: *RuleSet_classical
    path: './ruleset/Microsoft.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml' 
  
  Apple:
    <<: *RuleSet_classical
    path: './ruleset/Apple.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Classical.yaml'
  
  iCloudChina:
    <<: *RuleSet_classical
    path: './ruleset/iCloudChina.yaml'
    url: 'https://kelee.one/Tool/Clash/Rule/iCloudChina.yaml'  
  
  Game:
    <<: *RuleSet_classical
    path: './ruleset/Game.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Game/Game.yaml' 
  
  ProxyLite:
    <<: *RuleSet_classical
    path: './ruleset/ProxyLite.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ProxyLite/ProxyLite.yaml'
  
  Direct:
    <<: *RuleSet_classical
    path: './ruleset/Direct.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Direct/Direct.yaml' 
  
    
  Download: 
    <<: *RuleSet_classical
    path: './ruleset/Download.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Download/Download.yaml'  

  Lan:
    <<: *RuleSet_classical
    path: './ruleset/Lan.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.yaml'   
     
  CN_domain:
    <<: *RuleSet_domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs"

  CN_ip:
    <<: *RuleSet_ipcidr
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs"
    
    
  
# åˆ†æµPolicy 
rules:
  - RULE-SET,Telegram,Telegram
  - RULE-SET,YouTube,YouTube
  - RULE-SET,OpenAi,æ™ºèƒ½åŠ©ç†
  - RULE-SET,Google,è°·æ­ŒæœåŠ¡
  - RULE-SET,Emby,Emby
  - RULE-SET,Inside,DIRECT
  - RULE-SET,Outside,å…¨çƒåŠ é€Ÿ
  - RULE-SET,Github,å…¨çƒåŠ é€Ÿ
  - RULE-SET,ProxyLite,å…¨çƒåŠ é€Ÿ
  - RULE-SET,SpeedTest,DIRECT
  - RULE-SET,Microsoft,DIRECT
  - RULE-SET,Apple,DIRECT
  - RULE-SET,iCloudChina,DIRECT
  - RULE-SET,Game,DIRECT
  - RULE-SET,Direct,DIRECT
  - RULE-SET,Download,DIRECT
  - RULE-SET,Lan,DIRECT
  - RULE-SET,CN_domain,DIRECT
  - RULE-SET,CN_ip,DIRECT,no-resolve
  - GEOIP,CN,DIRECT
  - MATCH,å…¨çƒåŠ é€Ÿ
